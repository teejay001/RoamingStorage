async function onMessageSendHandler(e){Office.context.roamingSettings.set("lkey1","Launch_Val_1"),Office.context.roamingSettings.set("lkey2","Launch_Val_2"),await saveRoamingSetings(),Office.context.mailbox.item.body.getAsync("text",{asyncContext:e},getBodyCallback)}function saveRoamingSetings(){return new Promise(((e,t)=>{Office.context.roamingSettings.saveAsync((n=>{n.status===Office.AsyncResultStatus.Failed?(console.error(`Action failed with message ${n.error.message}`),t(n.error)):(console.log(`Roaming Settings saved with status: ${n.value}`),e(n.value))}))}))}function getBodyCallback(e){let t=e.asyncContext,n="";if(e.status===Office.AsyncResultStatus.Failed||void 0===e.value){let e="Failed to get body text";return console.error(e),void t.completed({allowEvent:!1,errorMessage:e})}n=e.value,hasMatches(n)?Office.context.mailbox.item.getAttachmentsAsync({asyncContext:t},getAttachmentsCallback):t.completed({allowEvent:!0})}function hasMatches(e){if(null==e||""==e)return!1;const t=["send","picture","document","attachment"];for(let n=0;n<t.length;n++){const o=t[n].trim();if(RegExp(o,"i").test(e))return!0}return!1}function getAttachmentsCallback(e){const t=`LaunchEvent - Vals from roaming setting: lkey1 = ${Office.context.roamingSettings.get("lkey1")} & lkey2 = ${Office.context.roamingSettings.get("lkey2")}`;console.log(t);const n=`Taskpane - Vals from roaming setting: tkey1 = ${Office.context.roamingSettings.get("tkey1")} & tkey2 = ${Office.context.roamingSettings.get("tkey2")}`;console.log(n);let o=e.asyncContext;if(e.value.length>0){for(let t=0;t<e.value.length;t++)if(0==e.value[t].isInline)return void o.completed({allowEvent:!0});o.completed({allowEvent:!1,errorMessage:`Looks like you forgot to include an attachment? ..  ${t} .. ${n}`})}else o.completed({allowEvent:!1,errorMessage:`Looks like you're forgetting to include an attachment?..  ${t} .. ${n}`})}Office.actions.associate("onMessageSendHandler",onMessageSendHandler);