function onMessageSendHandler(e){Office.context.roamingSettings.set("lkey1","Launch_Val_1"),Office.context.roamingSettings.set("lkey2","Launch_Val_2"),Office.context.mailbox.item.body.getAsync("text",{asyncContext:e},getBodyCallback)}function getBodyCallback(e){var t=e.asyncContext;if(e.status===Office.AsyncResultStatus.Failed||void 0===e.value){var n="Failed to get body text";return console.error(n),void t.completed({allowEvent:!1,errorMessage:n})}hasMatches(e.value)?Office.context.mailbox.item.getAttachmentsAsync({asyncContext:t},getAttachmentsCallback):t.completed({allowEvent:!0})}function hasMatches(e){if(null==e||""==e)return!1;for(var t=["send","picture","document","attachment"],n=0;n<t.length;n++){var a=t[n].trim();if(RegExp(a,"i").test(e))return!0}return!1}function getAttachmentsCallback(e){var t=Office.context.roamingSettings.get("lkey1"),n=Office.context.roamingSettings.get("lkey2");console.log("LaunchEvent - Vals from roaming setting: lkey1 = ".concat(t," & lkey2 = ").concat(n));var a=Office.context.roamingSettings.get("tkey1"),o=Office.context.roamingSettings.get("tkey2");console.log("Taskpane - Vals from roaming setting: tkey1 = ".concat(a," & tkey2 = ").concat(o));var c=e.asyncContext;if(e.value.length>0){for(var l=0;l<e.value.length;l++)if(0==e.value[l].isInline)return void c.completed({allowEvent:!0});c.completed({allowEvent:!1,errorMessage:"Looks like you forgot to include an attachment?"})}else c.completed({allowEvent:!1,errorMessage:"Looks like you're forgetting to include an attachment?"})}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);